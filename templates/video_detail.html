{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-lg-8">
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h3 class="card-title mb-3">{{ video.title }}</h3>
        <video controls class="w-100 mb-3">
          <source src="{{ video.blob_url }}">
          Your browser does not support the video tag.
        </video>
        <form action="{{ url_for('delete_video_route', video_id=video.id) }}" method="post" onsubmit="return confirm('Delete this video?');">
          <button type="submit" class="btn btn-danger">Delete video</button>
        </form>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h5 class="card-title">Comments ({{ video.comments|length }})</h5>
        {% if video.comments %}
          <ul class="list-group mb-3">
            {% for c in video.comments %}
              <li class="list-group-item">
                <strong>{{ c.author }}</strong>
                <div class="small text-muted">
                  {{ c.created_at.strftime('%Y-%m-%d %H:%M') }}
                </div>
                <div>{{ c.text }}</div>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <p class="text-muted">No comments yet.</p>
        {% endif %}

        <h6 class="mt-3">Add a comment</h6>
        <form action="{{ url_for('add_comment_route', video_id=video.id) }}" method="post">
          <div class="mb-2">
            <label for="author" class="form-label">Name</label>
            <input type="text" class="form-control" id="author" name="author" placeholder="Your name">
          </div>
          <div class="mb-2">
            <label for="text" class="form-label">Comment</label>
            <textarea class="form-control" id="text" name="text" rows="3" required></textarea>
          </div>
          <button type="submit" class="btn btn-primary btn-sm">Post comment</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
